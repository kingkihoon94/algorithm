# Streaming SSR이란?

Streaming SSR은 서버에서 렌더링된 HTML을 한 번에 완성해서 보내는 방식이 아니라, 준비된 부분부터 점진적으로 스트리밍해서 클라이언트에 전달하는 기술입니다. 이를 통해 사용자는 페이지의 중요한 콘텐츠를 더 빠르게 확인할 수 있습니다.

기존 SSR은 서버에서 모든 데이터를 처리한 뒤 완전한 HTML을 전송하는 반면, Streaming SSR은 서버가 데이터를 준비하는 즉시 HTML 조각을 스트림 형태로 보내고, 클라이언트는 이를 실시간으로 렌더링합니다. React 18에서는 `renderToPipeableStream` API를 통해 구현할 수 있으며, 이 API는 서버에서 HTML을 조각 단위로 스트리밍할 수 있도록 지원합니다.

```js
renderToPipeableStream(<App />, {
  onShellReady() {
    res.setHeader('Content-Type', 'text/html');
    stream.pipe(res);
  },
});
```

## 장점

1. **빠른 초기 로딩**: HTML 일부라도 준비되면 바로 렌더링 가능 → TTFB(Time to First Byte) 개선
2. **대규모 앱에 적합**: 데이터가 많은 애플리케이션에서도 사용자에게 중요한 콘텐츠를 먼저 보여줄 수 있음
3. **사용자 경험 향상**: 로딩 시간 감소로 인해 UX가 좋아짐

## 주의할 점

Streaming된 데이터와 React의 Hydration 과정에서 발생할 수 있는 문제로는 **HTML과 리액트 상태의 불일치**가 있습니다.

서버에서 먼저 전송된 HTML은 클라이언트에서 리액트가 실행되기 전까지 정적인 상태입니다. 이후 Hydration 과정에서 이 HTML에 이벤트 핸들러와 상태가 결합되는데, 이때 서버와 클라이언트의 데이터가 다르면 경고가 발생하거나 UI 동작이 어색해질 수 있습니다.

예를 들어,

* 서버에서 렌더링된 데이터가 클라이언트에서 이미 변경된 상태라면 예상치 못한 동작 발생 가능
* Suspense를 사용한 비동기 데이터 로딩 시 UI 불일치 가능성 존재

## 해결 방법

1. **서버-클라이언트 데이터 소스 통일**: 동일한 데이터를 양쪽에서 사용하도록 유지
2. **데이터 동기화 라이브러리 사용**: Tanstack Query 등으로 SSR + Hydration 환경에서 데이터 일관성 확보
3. **Suspense + fallback 활용**: 데이터가 준비되지 않아도 사용자에게 안정적인 화면 제공

## 결론

Streaming SSR은 기존 SSR의 한계를 극복하며 더욱 빠르고 효율적인 렌더링을 가능하게 합니다. 하지만 Hydration 설계와 SEO, 캐싱 전략 등을 함께 고려해야 안정적인 도입이 가능합니다.
