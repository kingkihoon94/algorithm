# 브라우저 렌더링 파이프라인

브라우저가 웹 페이지를 화면에 표시하기 위해 거치는 과정을 **브라우저 렌더링 파이프라인**이라고 합니다. 이 과정은 크게 6단계로 나눌 수 있습니다.

---

## 1. DOM 생성

브라우저가 HTML 파일을 받으면, 이 파일을 **바이트(byte)** 단위로 읽기 시작합니다. 브라우저의 **HTML 파서(Parser)** 는 이 바이트들을 **문자(character)** 로 변환하고, 이 문자들을 다시 **HTML 토큰**으로 변환합니다.  
이 HTML 토큰들은 각각의 **태그와 그 안에 포함된 텍스트, 속성** 등을 의미하게 됩니다.

HTML 토큰이 생성되면, 브라우저는 이를 기반으로 **DOM 트리**를 생성합니다. DOM 트리는 HTML 문서의 구조를 트리 형태로 표현한 것으로, 각 태그가 **노드(node)** 가 되어 **부모-자식 관계**를 형성합니다.  
예를 들어, `<body>` 태그 아래에 `<div>`가 있다면, DOM 트리에서도 `<body>` 노드 아래에 `<div>` 노드가 있게 됩니다.

---

## 2. CSSOM 생성

브라우저는 **CSS 파일을 파싱(parse)** 합니다. CSS 파일 역시 바이트로 전송되므로, 브라우저는 이를 문자로 변환한 뒤, **CSS 규칙**으로 나눕니다.  
각 CSS 규칙은 **선택자(selector)** 와 **선언(declaration)** 으로 구성됩니다.

- **선택자**: 스타일을 적용할 HTML 요소를 정의  
- **선언**: 적용할 스타일을 정의

브라우저는 이 CSS 규칙들을 기반으로 **CSSOM 트리**를 생성합니다. CSSOM 트리는 DOM과 유사하게 **트리 구조**를 가지며, 각 노드는 해당 노드에 적용될 **스타일 정보**를 포함합니다.

---

## 3. 렌더 트리 생성

이제 브라우저는 **DOM과 CSSOM을 결합**하여 **렌더 트리(Render Tree)** 를 생성합니다.  
렌더 트리는 **화면에 실제로 표시될 요소들**로만 구성됩니다.

예를 들어 `display: none` 속성이 있는 요소는 렌더 트리에 포함되지 않습니다.  
렌더 트리의 각 노드는 DOM 트리의 요소와 연결되며, CSSOM 트리에서 해당 요소에 적용된 **스타일 정보를 포함**합니다.

즉, 렌더 트리는 **HTML 구조 + 스타일 정보**를 모두 포함한 트리입니다.

---

## 4. 레이아웃 (Layout)

렌더 트리가 생성된 후, 브라우저는 이 트리를 사용해 각 요소의 **정확한 위치와 크기**를 계산합니다.  
이 과정을 **레이아웃(Layout)** 또는 **리플로우(Reflow)** 라고 부릅니다.

레이아웃 계산은 **뷰포트(viewport)** 크기와 같은 정보에 의존하며,  
화면 크기가 변경되면 브라우저는 **다시 레이아웃을 수행**해야 합니다.

리플로우는 **성능에 영향을 줄 수 있으므로 최소화**하는 것이 중요합니다.

---

## 5. 페인팅 (Painting)

레이아웃이 완료되면, 브라우저는 각 요소를 **실제로 화면에 그리는 작업**을 시작합니다. 이 과정을 **페인팅(Painting)** 이라고 합니다.

이 단계에서는 **텍스트, 색상, 그림자, 이미지 등 모든 시각적 요소**가 화면에 그려집니다.  
**복잡한 그래픽이나 애니메이션**이 포함된 경우, 페인팅 작업이 많아져 성능이 저하될 수 있습니다.

---

## 6. 컴포지팅 (Compositing)

마지막 단계에서는 브라우저가 각 요소를 **레이어(layer)** 로 분리하고, 이 레이어들을 **결합하여 최종 화면**을 구성합니다.  
이 과정에서 **GPU를 활용하여 빠르게 합성**합니다.

`transform`이나 `opacity` 속성은 **레이아웃이나 페인트를 거치지 않고**  
**컴포지팅 단계에서만 처리**되기 때문에, 이러한 속성을 사용하는 애니메이션은 더 **부드럽고 빠르게 실행**됩니다.

컴포지팅 단계는 **GPU 가속을 활용하여 성능을 최적화**하고, **화면에 최종적으로 표시되는 결과**를 빠르게 생성하는 데 중요한 역할을 합니다.
