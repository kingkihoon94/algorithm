# 이벤트 버블링과 캡처링

## 1. 이벤트 버블링이란?

이벤트 버블링은 이벤트가 발생했을 때 가장 안쪽의 타겟 요소에서 시작하여 부모 요소로 전파되는 방식입니다.

예를 들어, 버튼을 클릭했을 때 버튼 자체에서 이벤트가 발생한 후 이 이벤트가 상위 요소인 div, body, document, window로 전파되는 과정을 거치게 됩니다. 기본적으로 브라우저는 이벤트 전파를 버블링 단계에서 처리하도록 설계되어 있습니다.

## 2. 이벤트 캡처링이란?

이벤트 캡처링은 버블링과 반대 방향으로 진행됩니다.

즉, 이벤트가 최상위 부모 요소에서부터 시작해 점점 타겟 요소로 내려오면서 전파됩니다. 예를 들어, window에서 이벤트가 시작되어 document, body, div를 거쳐 버튼에 도달하게 되는 방식입니다. 기본적으로 캡처링 단계는 비활성화되어 있지만, `addEventListener` 함수의 세 번째 옵션을 `true`로 설정하면 캡처링 단계에서 이벤트를 처리할 수 있습니다.

## 3. 활용 예시

### - 이벤트 버블링 활용: 이벤트 위임

버블링은 특히 **이벤트 위임**에서 매우 유용합니다. 예를 들어, 동적으로 생성되는 여러 자식 요소가 있을 때 각각에 이벤트 리스너를 붙이지 않고, 부모 요소 하나에만 리스너를 등록하여 자식 이벤트를 처리할 수 있습니다.

예시:

```html
<ul id="menu">
  <li>항목 1</li>
  <li>항목 2</li>
</ul>
```

```js
document.getElementById('menu').addEventListener('click', (e) => {
  if (e.target.tagName === 'LI') {
    console.log('클릭한 항목:', e.target.textContent);
  }
});
```

### - 캡처링 활용: 로깅, 트래킹 등 상위 우선 처리

부모 요소에서 자식 요소보다 **먼저 이벤트를 감지**하고 싶을 때 유용합니다. 예를 들어, 페이지 전반에 대한 **사용자 행동 추적**이나 **로깅 기능**을 캡처링 단계에서 처리하면, 하위 요소의 처리 여부와 상관없이 부모 단계에서 선제적으로 로직을 실행할 수 있습니다.

```js
window.addEventListener('click', () => {
  console.log('모든 클릭을 추적합니다.');
}, true); // 캡처링 단계에서 실행
```

## 4. 발생 가능한 문제점과 해결 방법

| 문제 유형        | 설명                    | 해결 방법                       |
| ------------ | --------------------- | --------------------------- |
| 이벤트 중복 처리    | 동일 이벤트가 여러 요소에서 중복 실행 | `stopPropagation()`으로 전파 중단 |
| 불필요한 성능 낭비   | 캡처링 단계에서 과도한 리스너 실행   | 필요 시 캡처링 최소화 또는 제거          |
| 이벤트 위임 시 오작동 | 잘못된 `e.target` 처리     | 정확한 타겟 조건 분기 필요             |

## 5. 관련 메서드 요약

* `stopPropagation()`

  * 이벤트 전파(버블링/캡처링)를 **현재 단계에서 중단**
  * 복잡한 UI 구조에서 불필요한 중첩 이벤트 방지

* `preventDefault()`

  * 브라우저의 **기본 동작 차단** (예: a 태그 클릭 → 이동 방지, 폼 제출 차단)

---

버블링과 캡처링은 자바스크립트 이벤트 시스템의 중요한 개념으로, 상황에 맞게 적절히 활용하면 유연하고 성능 좋은 UI를 구성할 수 있습니다.
